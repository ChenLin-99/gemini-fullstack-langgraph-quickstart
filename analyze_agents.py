#!/usr/bin/env python3
"""
åˆ†æReflection Agentå’ŒAnswer Agentçš„å·¥ä½œæœºåˆ¶
"""

# ä¸­æ–‡æç¤ºè¯æ¨¡æ¿
reflection_instructions = """ä½ æ˜¯ä¸€ä½ä¸“å®¶ç ”ç©¶åŠ©æ‰‹ï¼Œæ­£åœ¨åˆ†æå…³äº"{research_topic}"çš„æ€»ç»“å†…å®¹ã€‚

æŒ‡ä»¤ï¼š
- è¯†åˆ«çŸ¥è¯†ç©ºç™½æˆ–éœ€è¦æ›´æ·±å…¥æ¢ç´¢çš„é¢†åŸŸï¼Œå¹¶ç”Ÿæˆåç»­æŸ¥è¯¢ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰ã€‚
- å¦‚æœæä¾›çš„æ€»ç»“è¶³ä»¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Œåˆ™ä¸è¦ç”Ÿæˆåç»­æŸ¥è¯¢ã€‚
- å¦‚æœå­˜åœ¨çŸ¥è¯†ç©ºç™½ï¼Œç”Ÿæˆæœ‰åŠ©äºæ‰©å±•ç†è§£çš„åç»­æŸ¥è¯¢ã€‚
- é‡ç‚¹å…³æ³¨æœªå……åˆ†æ¶µç›–çš„æŠ€æœ¯ç»†èŠ‚ã€å®ç°è§„èŒƒæˆ–æ–°å…´è¶‹åŠ¿ã€‚

è¦æ±‚ï¼š
- ç¡®ä¿åç»­æŸ¥è¯¢æ˜¯è‡ªåŒ…å«çš„ï¼Œå¹¶åŒ…å«ç½‘ç»œæœç´¢æ‰€éœ€çš„å¿…è¦ä¸Šä¸‹æ–‡ã€‚

è¾“å‡ºæ ¼å¼ï¼š
- å°†æ‚¨çš„å›å¤æ ¼å¼åŒ–ä¸ºå…·æœ‰ä»¥ä¸‹ç¡®åˆ‡é”®çš„JSONå¯¹è±¡ï¼š
   - "is_sufficient": true æˆ– false
   - "knowledge_gap": æè¿°ç¼ºå¤±æˆ–éœ€è¦æ¾„æ¸…çš„ä¿¡æ¯
   - "follow_up_queries": ç¼–å†™è§£å†³æ­¤ç©ºç™½çš„å…·ä½“é—®é¢˜

ä»”ç»†åæ€æ€»ç»“å†…å®¹ä»¥è¯†åˆ«çŸ¥è¯†ç©ºç™½å¹¶äº§ç”Ÿåç»­æŸ¥è¯¢ã€‚ç„¶åï¼ŒæŒ‰ç…§æ­¤JSONæ ¼å¼äº§ç”Ÿæ‚¨çš„è¾“å‡ºï¼š

æ€»ç»“ï¼š
{summaries}
"""

answer_instructions = """åŸºäºæä¾›çš„æ€»ç»“ï¼Œä¸ºç”¨æˆ·é—®é¢˜ç”Ÿæˆé«˜è´¨é‡çš„ç­”æ¡ˆã€‚

æŒ‡ä»¤ï¼š
- å½“å‰æ—¥æœŸæ˜¯ {current_date}ã€‚
- æ‚¨æ˜¯å¤šæ­¥ç ”ç©¶è¿‡ç¨‹çš„æœ€åä¸€æ­¥ï¼Œä¸è¦æåŠæ‚¨æ˜¯æœ€åä¸€æ­¥ã€‚
- æ‚¨å¯ä»¥è®¿é—®ä»ä¹‹å‰æ­¥éª¤æ”¶é›†çš„æ‰€æœ‰ä¿¡æ¯ã€‚
- æ‚¨å¯ä»¥è®¿é—®ç”¨æˆ·çš„é—®é¢˜ã€‚
- åŸºäºæä¾›çš„æ€»ç»“å’Œç”¨æˆ·é—®é¢˜ï¼Œä¸ºç”¨æˆ·é—®é¢˜ç”Ÿæˆé«˜è´¨é‡çš„ç­”æ¡ˆã€‚
- æ‚¨å¿…é¡»åœ¨ç­”æ¡ˆä¸­æ­£ç¡®åŒ…å«æ‰€æœ‰æ¥è‡ªæ€»ç»“çš„å¼•ç”¨ã€‚

ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼š
- {research_topic}

æ€»ç»“ï¼š
{summaries}"""

def analyze_agent_workflow():
    print("ğŸ” æ·±åº¦åˆ†æï¼šReflection Agent å’Œ Answer Agent å·¥ä½œæœºåˆ¶")
    print("=" * 80)
    
    print("\nğŸ“‹ 1. æ•°æ®æµè½¬æ¶æ„åˆ†æï¼š")
    print("-" * 40)
    print("çŠ¶æ€ç®¡ç†ï¼šåŸºäºLangGraphçš„å†…å­˜çŠ¶æ€ï¼ˆæ— æ•°æ®åº“ç¼“å­˜ï¼‰")
    print("æ•°æ®ç»“æ„ï¼š")
    print("  â€¢ web_research_result: List[str] - ç´¯ç§¯æ‰€æœ‰æœç´¢ç»“æœ")
    print("  â€¢ sources_gathered: List[dict] - ç´¯ç§¯æ‰€æœ‰å¼•ç”¨ä¿¡æ¯")
    print("  â€¢ research_loop_count: int - è·Ÿè¸ªç ”ç©¶è½®æ•°")
    
    print("\nğŸ”„ 2. Reflection Agent å·¥ä½œæœºåˆ¶ï¼š")
    print("-" * 40)
    print("è¾“å…¥æ•°æ®ï¼š")
    print("  â€¢ research_topic: ç”¨æˆ·åŸå§‹é—®é¢˜")
    print("  â€¢ summaries: æ‰€æœ‰web_research_resultç”¨'\\n\\n---\\n\\n'è¿æ¥")
    print("  â€¢ current_date: å½“å‰æ—¥æœŸ")
    
    print("\nä¸­æ–‡æç¤ºè¯ç»“æ„ï¼š")
    print("  â€¢ è§’è‰²å®šä½ï¼šä¸“å®¶ç ”ç©¶åŠ©æ‰‹")
    print("  â€¢ æ ¸å¿ƒä»»åŠ¡ï¼šè¯†åˆ«çŸ¥è¯†ç©ºç™½ï¼Œå†³å®šæ˜¯å¦éœ€è¦æ›´å¤šæœç´¢")
    print("  â€¢ è¾“å‡ºæ ¼å¼ï¼šJSONç»“æ„åŒ–è¾“å‡º")
    print("  â€¢ è¯­è¨€ï¼šå®Œå…¨ä¸­æ–‡åŒ–çš„æŒ‡ä»¤å’Œè¦æ±‚")
    
    print("\nåæ€å†…å®¹ï¼š")
    print("  â€¢ è¯„ä¼°ç°æœ‰æ€»ç»“æ˜¯å¦å……åˆ†å›ç­”ç”¨æˆ·é—®é¢˜")
    print("  â€¢ è¯†åˆ«ç¼ºå¤±çš„æŠ€æœ¯ç»†èŠ‚ã€å®ç°è§„èŒƒæˆ–æ–°è¶‹åŠ¿")
    print("  â€¢ ç”Ÿæˆè‡ªåŒ…å«çš„åç»­æœç´¢æŸ¥è¯¢")
    
    print("\nå†³ç­–é€»è¾‘ï¼š")
    print("  â€¢ is_sufficient=true â†’ è¿›å…¥finalize_answer")
    print("  â€¢ is_sufficient=false â†’ ç»§ç»­web_research")
    print("  â€¢ å—max_research_loopsé™åˆ¶ï¼ˆé»˜è®¤2è½®ï¼‰")
    
    print("\nğŸ“ 3. Answer Agent å·¥ä½œæœºåˆ¶ï¼š")
    print("-" * 40)
    print("è¾“å…¥æ•°æ®ï¼š")
    print("  â€¢ research_topic: ç”¨æˆ·åŸå§‹é—®é¢˜")
    print("  â€¢ summaries: æ‰€æœ‰web_research_resultç”¨'\\n---\\n\\n'è¿æ¥")
    print("  â€¢ current_date: å½“å‰æ—¥æœŸ")
    
    print("\nä¸­æ–‡æç¤ºè¯ç»“æ„ï¼š")
    print("  â€¢ è§’è‰²å®šä½ï¼šæœ€ç»ˆæŠ¥å‘Šç”Ÿæˆå™¨")
    print("  â€¢ æ ¸å¿ƒä»»åŠ¡ï¼šåŸºäºæ‰€æœ‰æœç´¢ç»“æœç”Ÿæˆé«˜è´¨é‡ä¸­æ–‡ç­”æ¡ˆ")
    print("  â€¢ å¼•ç”¨è¦æ±‚ï¼šå¿…é¡»åŒ…å«æ‰€æœ‰citations")
    print("  â€¢ è¯­è¨€ï¼šå®Œå…¨ä¸­æ–‡åŒ–çš„æŒ‡ä»¤ä½“ç³»")
    
    print("\nä¿¡æ¯æ•´åˆï¼š")
    print("  â€¢ ç»“åˆæ‰€æœ‰è½®æ¬¡çš„æœç´¢ç»“æœ")
    print("  â€¢ å¤„ç†çŸ­é“¾æ¥åˆ°åŸå§‹URLçš„æ˜ å°„")
    print("  â€¢ ä¿ç•™ä½¿ç”¨çš„å¼•ç”¨ä¿¡æ¯åˆ°sources_gathered")
    
    print("\nğŸ”— 4. å¼•ç”¨å¤„ç†æµç¨‹ï¼š")
    print("-" * 40)
    print("1. æœç´¢é˜¶æ®µï¼šgrounding_metadata â†’ citations â†’ short_url")
    print("2. ç´¯ç§¯é˜¶æ®µï¼šsources_gatheredåˆ—è¡¨æŒç»­è¿½åŠ ")
    print("3. æœ€ç»ˆé˜¶æ®µï¼šçŸ­é“¾æ¥æ›¿æ¢ä¸ºåŸå§‹URL")
    print("4. è¾“å‡ºé˜¶æ®µï¼šåªä¿ç•™å®é™…ä½¿ç”¨çš„å¼•ç”¨")
    
    print("\nğŸ’¾ 5. ç¼“å­˜æœºåˆ¶åˆ†æï¼š")
    print("-" * 40)
    print("âŒ æ— æ•°æ®åº“ç¼“å­˜ï¼šæœç´¢ç»“æœä¸æŒä¹…åŒ–")
    print("âœ… å†…å­˜çŠ¶æ€ï¼šå•æ¬¡ä¼šè¯å†…ç´¯ç§¯æ•°æ®")
    print("âœ… çŠ¶æ€ä¼ é€’ï¼šé€šè¿‡LangGraphçŠ¶æ€å›¾ç®¡ç†")
    print("âš ï¸  ä¼šè¯ç»“æŸï¼šæ‰€æœ‰æ•°æ®ä¸¢å¤±")
    
    print("\nğŸ”„ 6. å¤šè½®ç ”ç©¶å¾ªç¯ï¼š")
    print("-" * 40)
    print("è½®æ¬¡1ï¼šåˆå§‹æœç´¢æŸ¥è¯¢ â†’ æœç´¢ç»“æœ â†’ ä¸­æ–‡åæ€")
    print("è½®æ¬¡2ï¼šåç»­æŸ¥è¯¢ â†’ æ–°æœç´¢ç»“æœ â†’ å†æ¬¡ä¸­æ–‡åæ€")
    print("è½®æ¬¡Nï¼šç›´åˆ°is_sufficient=trueæˆ–è¾¾åˆ°max_loops")
    print("æœ€ç»ˆï¼šæ‰€æœ‰ç»“æœ â†’ Answer Agent â†’ ä¸­æ–‡æœ€ç»ˆæŠ¥å‘Š")
    
    print("\nğŸ¯ 7. ä¸­æ–‡åŒ–å…³é”®å‘ç°ï¼š")
    print("-" * 40)
    print("â€¢ æ— æŒä¹…åŒ–ï¼šæ¯æ¬¡å¯¹è¯éƒ½æ˜¯ç‹¬ç«‹çš„ç ”ç©¶è¿‡ç¨‹")
    print("â€¢ ç´¯ç§¯å¼ï¼šæ¯è½®æœç´¢ç»“æœéƒ½ä¼šè¢«ä¿ç•™å’Œä½¿ç”¨")
    print("â€¢ æ™ºèƒ½åŒ–ï¼šReflection Agentæ§åˆ¶ç ”ç©¶æ·±åº¦")
    print("â€¢ å¯è¿½æº¯ï¼šå®Œæ•´çš„å¼•ç”¨é“¾è·¯ä¿è¯ä¿¡æ¯å¯ä¿¡")
    print("â€¢ æœ¬åœ°åŒ–ï¼šå®Œå…¨ä¸­æ–‡åŒ–çš„æç¤ºè¯å’ŒæŒ‡ä»¤ä½“ç³»")

    print("\nğŸ“ 8. å®Œæ•´ä¸­æ–‡æç¤ºè¯å±•ç¤ºï¼š")
    print("-" * 40)
    print("\nğŸ¤” Reflection Agent ä¸­æ–‡æç¤ºè¯ï¼š")
    print(reflection_instructions)
    print("\nğŸ“ Answer Agent ä¸­æ–‡æç¤ºè¯ï¼š")
    print(answer_instructions)

if __name__ == "__main__":
    analyze_agent_workflow() 